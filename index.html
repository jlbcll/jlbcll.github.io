<!DOCTYPE html>
<html style="height: auto; min-height: 100%;" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
        游戏火车</title>

    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="static/css/bootstrap.min.css">
    <link rel="stylesheet" href="static/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="static/css/font-awesome.min_1.css"/>
    <!--[if IE 7]>
    <link rel="stylesheet" href="static/css/font-awesome-ie7.min.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="static/css/ace-ie.min.css"/><![endif]--><!--[if lt IE 9]>
    <script src="static/js/html5shiv.js"></script>
    <script src="static/js/respond.min.js"></script><![endif]-->
    <link rel="stylesheet" href="static/css/ionicons.min.css">
    <link rel="stylesheet" href="static/css/adminlte.min.css">
    <!--[if lt IE 9]>
    <script src="static/js/html5shiv.min.js"></script>
    <script src="static/js/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="static/css/font.css">
    <link rel="stylesheet" href="static/css/base.css"/>
    <script src="static/js/jquery.min.js"></script>
    <link href="static/css/normalize.min.css" rel="stylesheet">
    <link href="static/css/bootstrap.min_1.css" rel="stylesheet">
    <script src="static/js/bootstrap.min.js"></script>
    <link href="static/css/font-awesome.css" rel="stylesheet">



    


    <script type="text/javascript" src="static/js/bootstrap-notify.min.js"></script>
    <link rel="stylesheet" type="text/css" href="static/css/style.css" />
    <link rel="stylesheet" type="text/css" href="static/css/loaders.min.css" />
    <script type="text/javascript" src="static/js/loaders.css.js"></script>
    <link rel="stylesheet" type="text/css" href="static/css/toastr.css" />


    <script src="static/js/toastr.js"></script>


</head>
<body class="skin-blue layout-top-nav" style="height: auto; min-height: 100%;">
<header class="main-header">
    <nav class="navbar navbar-static-top">
        <div class="container">
            <div class="navbar-header">
                <a href="./index" class="navbar-brand"><i class="fa fa-steam"></i> 游戏火车</a>
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#navbar-collapse">
                    <i class="fa fa-bars"></i>
                </button>
            </div>



                    

                </ul>
            </div>

          
            <div class="CheckCards">
                <center><h2>查询所需数量</h2></center>
                <div class="Check-Box">
                    <div class="Check-Title">

                        
                        <h3 style="font-weight: 600;margin-bottom: 5px;color: #4ea2d3;">STEAM等级计算器</h3>

                        <!--
                        <p class="tolevel">您目前的等级</p><input class="nowlevel"
                                                            style="border:2px solid black;background-color:transparent;"
                                                            type="number" min="0" max="9999"
                                                            length="4"
                                                            onkeyup="this.value=this.value.replace(/[^0-9]/g,'')"
                                                            onafterpaste="this.value=this.value.replace(/[^0-9]/g,'')">
                        <p class="tolevel" style="margin-left:5px;">需求目标等级</p><input class="tolevel input-standard-grey"
                                                                                     style="border:2px solid black;background-color:transparent;"
                                                                                     type="number" min="0"
                                                                                     max="9999" length="4"
                                                                                     onkeyup="this.value=this.value.replace(/[^0-9]/g,'')"
                                                                                     onafterpaste="this.value=this.value.replace(/[^0-9]/g,'')">

                                                                                     -->

                    </div>

                    <div class="Check-Title">

                        <p class="tolevel"  style="">买家当前的Steam等级</p><input class="nowlevel"
                                                            style="border:2px solid black;background-color:transparent; "
                                                            type="number" min="0" max="9999"
                                                            length="4"
                                                            onkeyup="this.value=this.value.replace(/[^0-9]/g,'')"
                                                            onafterpaste="this.value=this.value.replace(/[^0-9]/g,'')">
                        <p class="tolevel" style="margin-left:5px;">需求目标等级</p><input class="tolevel input-standard-grey"
                                                                                     style="border:2px solid black;background-color:transparent;"
                                                                                     type="number" min="0"
                                                                                     max="9999" length="4"
                                                                                     onkeyup="this.value=this.value.replace(/[^0-9]/g,'')"
                                                                                     onafterpaste="this.value=this.value.replace(/[^0-9]/g,'')">
                    </div>
                    <div class="Check-Content">
                        <div class="content-box">
                            <div class="Cards-info">
                                <div class="container">
                                    <center class="CheckCards-cellback">
                                        <div class="row" style="display: inline;">
                                            <div class="col-md-4">
                                                <p class="Cards-info" id="needxp">0</p>
                                                <p class="Cards-info-title">升级需要套数</p>
                                            </div>


                                        </div>
                                        <hr>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <p class="Cards-info" id="maxfriend">0</p>
                                                <p class="Cards-info-title">好友上限</p>
                                            </div>
                                            <div class="col-md-4">
                                                <p class="Cards-info" id="showarea">0</p>
                                                <p class="Cards-info-title">展柜数</p>
                                            </div>
                                    
                                        </div>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                        <!--

                        </a>
                    </div>

                </div>
            </div>
   

                        </div>
     -->

                    </div>

                </div>


            </div>

        </div>



    </div>

    <div class="GetTrade" id="GetTradeInfo" style="display:none;">
        <center><h3>订单详细信息</h3></center>
        <div id="trade-li1nk-anchor" class="wrapper trade-link-anchor_class ">

            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->

                <div class="trade-link__box clearfix ">
                    <div class="GetTrade__box__label">状态</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoStatusSHOW" readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->

                <div class="trade-link__box clearfix ">

                    <div class="GetTrade__box__label">淘宝订单号</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoIdSHOW" readonly="readonly">
                    </div>
                </div>

            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->

                <div class="trade-link__box clearfix ">

                    <div class="GetTrade__box__label">淘宝用户名</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoBuyerNickSHOW" readonly="readonly">
                    </div>

                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->

                <div class="trade-link__box clearfix ">

                    <div class="GetTrade__box__label">Steam报价链接</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoOwnerUrlSHOW" readonly="readonly">
                    </div>

                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->

                <div class="trade-link__box clearfix ">

                    <div class="GetTrade__box__label">商品标题</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoTitleSHOW" readonly="readonly">
                    </div>
                </div>
            </div>

            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->

                <div class="trade-link__box clearfix ">

                    <div class="GetTrade__box__label">当前等级</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoFromLevelSHOW" readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->

                <div class="trade-link__box clearfix ">

                    <div class="GetTrade__box__label">目标等级</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoToLevelSHOW" readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->
                <div class="trade-link__box clearfix ">
                    <div class="GetTrade__box__label">卡牌套数</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoNumSHOW" readonly="readonly">
                    </div>
                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->
                <div class="trade-link__box clearfix ">
                    <div class="GetTrade__box__label">订单总价</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoPriceSHOW" readonly="readonly">
                    </div>

                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->
                <div class="trade-link__box clearfix ">
                    <div class="GetTrade__box__label">Steam报价ID</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoOfferIdSHOW">
                    </div>
                </div>
            </div>
            <div class="trade-link hint-aim-2" style=""><!-- class="trade-link is-show-info" -->
                <div class="trade-link__box clearfix ">
                    <div class="GetTrade__box__label">报错信息</div>
                    <div class="GetTrade__box__field">
                        <input type="text" id="TaoBaoErrorSHOW">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" id="HelpModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h3 class="modal-title billing-detail-title" id="myModalLabelbilling-cellback-title">
                        取卡帮助
                    </h3>
                </div>
                <div class="modal-body">
                    <div class="billing-detail-content">
                        <h2>一.如何取卡？</h2>
                        <p style="font-size: 15px;">
                            1.前往淘宝的 [已购买宝贝] 找到订单 ， 找到订单号<br>
                            <img src="static/picture/help-taobao.png" style="width:100%;"/>
                            <br><br>
                            2.找到自己的淘宝用户名<br>
                            <img src="static/picture/help-taobao-2.png" style="width:100%;"/>
                            <br><br>
                            3.在我们网站内填写 [订单号] 和 [淘宝用户名] 来取回订单
                            <img src="static/picture/help-taobao-3.png" style="width:100%;"/>
                            <br><br>
                        <hr>
                        如何在手机版淘宝寻找自己的淘宝昵称
                        <img src="static/picture/nicknamefromphone.png" style="width:100%;"/>
                        <br><br>

                        </p>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div><!-- /.modal -->
    </div>
    </div>



        </div>
    </a>
</div>




    <script>
        //  $("#Remind").show();
       //  $("#TradeLink").show();


        var steamlvnow;
        var tosteamlvnow;
        var tradelink;
        //$("#GetTrade").show();
        function showError(errormessage) {
            $('#Reminddiv').text(errormessage);
            $("#Remind").show();
            toastr.error(errormessage);

        }

        function hideError() {
            $('#Reminddiv').text("");
            $("#Remind").hide();
        }

        function CheckBuyNum() {
            $(".Buy-Num-Cellback").html('<div class="loader-inner ball-pulse-sync"><div></div><div></div><div></div></div>');
            $('button#CheckBuyNum').attr('disabled', "true");//添加disabled属性


            var postData = {
                "type": 1
            }
            // 验证是否通过
            $.post("/index.php/Home/Index/checkBuyNum", postData, function (data) {
                $('button#CheckBuyNum').removeAttr("disabled");
                if (data == null) {
                    showError("请求失败 请再次尝试");
                } else if (data["success"]) {
                    $("#hismaxset").html(data['botsets']);
                    $("#botnsets").html(data['botsets']);
                    $("#gamenum").html(data['gamenum']);
                    $(".Buy-Num-Cellback").html("");


                } else if (!data["success"]) {
                    $(".Buy-Num-Cellback").html(data['error']);
                }
                $('button#CheckBuyNum').removeAttr("disabled");
            });

        }


        function CheckTrade() {
            hideError();
            var TaoBaoID = $("#TaoBaoID").val().trim();
            var TaoBaoBuyNick = $("#TaoBaoBuyNick").val().trim();
            if (TaoBaoID.length != 17 && TaoBaoID.length != 18 && TaoBaoID.length != 19) {
                showError("TaoBao的订单号输入错误, 为啥 你输入了" + TaoBaoID.length + "位");
                return;
            } else if (TaoBaoBuyNick.length == 0) {
                showError("淘宝用户名异常!!!请仔细检查后再提交");
                return;
            }
            var postData = {
                TaoBaoID: TaoBaoID,
                TaoBaoBuyNick: TaoBaoBuyNick
            }
            // 验证是否通过
            $.post("/index.php/Home/Index/getTrade", postData, function (data) {
                if (data == null) {
                    showError("请求失败 请再次尝试");
                } else if (data["success"]) {
                    $('#TaoBaoID').attr("readonly", "readonly");
                    $('#TaoBaoBuyNick').attr("readonly", "readonly");
                    $("#CheckTaoBao1Info").remove();
                    $("#TaoBaoStatusSHOW").val(data["data"]["TaoBaoStatusSHOW"]);
                    $("#TaoBaoBuyerNickSHOW").val(data["data"]["TaoBaoBuyerNickSHOW"]);
                    $("#TaoBaoIdSHOW").val(data["data"]["TaoBaoIdSHOW"]);
                    $("#TaoBaoTitleSHOW").val(data["data"]["TaoBaoTitleSHOW"]);

                    $("#TaoBaoPriceSHOW").val(data["data"]["TaoBaoPriceSHOW"]);
                    $("#TaoBaoOwnerUrlSHOW").val(data["data"]["TaoBaoOwnerUrlSHOW"]);
                    $("#TaoBaoOfferIdSHOW").val(data["data"]["TaoBaoOfferIdSHOW"]);
                    $("#TaoBaoErrorSHOW").val(data["data"]["TaoBaoErrorSHOW"]);

                    $("#SteamlevelToBox").val(data["data"]["TaoBaoToSteamLevelSHOW"]);
                    $("#TaoBaoNumSHOW").val(data["data"]["TaoBaoCardNumSHOW"]);
                    $("#TaoBaoFromLevelSHOW").val(data["data"]["TaoBaoSteamLevelSHOW"]);
                    $("#TaoBaoToLevelSHOW").val(data["data"]["TaoBaoToSteamLevelSHOW"]);
                    $("#steamlevelBox").val(data["data"]["TaoBaoSteamLevelSHOW"]);
                     steamlvnow=data["data"]["TaoBaoSteamLevelSHOW"];
                    tradelink=data["data"]["TaoBaoOwnerUrlSHOW"];
                    if(data["data"]["TaoBaoSteamLevelSHOW"] ==""||data["data"]["TaoBaoOwnerUrlSHOW"].length<=20){

                        $("#Confirm_Trade").text("请保存交易链接,等级后点击领取")
                        $("#Confirm_Trade").attr({"disabled":"true"});
                    }else {
                        $("#Confirm_Trade").text("点击领取")
                        $("#Confirm_Trade").attr({"disabled":false})
                    }

                    if (data["data"]["TaoBaoOwnerUrlSHOW"].length > 20) {
                        $("#TradeLinkBox").val(data["data"]["TaoBaoOwnerUrlSHOW"]);
                    }

                    $("#GetTradeInfo").show();
                    if (data["data"]["status"] == "2" || data["data"]["status"] == "9") {
                        $("#TradeLink").hide();
                    } else {
                        $("#TradeLink").show();
                        if (data["data"]["TaoBaoErrorSHOW"].length > 0) {
                            showError(data["data"]["TaoBaoErrorSHOW"]);
                        }
                    }
                } else if (!data["success"]) {
                    showError(data["error"]);
                }
            });
        }


        function confirmTradeLink() {
            var url = $("#TradeLinkBox").val();
            var CheckURL = parseURL(url);
            var token = CheckURL.params.token;
            var partner = CheckURL.params.partner;
            if (url == "" || typeof(token) == "undefined" || typeof(partner) == "undefined" || token == void(0) || partner == void(0) || token == "" || partner == "") {
                showError("请输出正确的交易报价链接啊 !!!!!!!!!!!!");
                return;
            }
            var postData = {
                TaoBaoID: $("#TaoBaoID").val(),
                partner: partner,
                token: token
            }
            //  $("#TradeLink").hide();
            $.post("/index.php/Home/Index/confirmTradeLink", postData, function (data) {
                if (data == null) {
                    showError("请求失败 请再次尝试");
                } else if (data["success"]) {
                    toastr.info("保存成功")
                    getTradeDetail();

                } else if (!data["success"]) {
                    showError(data["error"]);
                    $("#TradeLink").show();
                }
            })
        }

        function confirmSteamLevel() {
            var url = $("#TradeLinkBox").val();
            var steamlevel = $("#steamlevelBox").val();


            if (steamlevel == "" || typeof(steamlevel) == "undefined") {
                showError("请输入您当前正确的Steam等级啊 !!!!!!!!!!!!");
                return;
            }


            var postData = {
                TaoBaoID: $("#TaoBaoID").val(),
                SteamLevel: steamlevel

            }
            //  $("#TradeLink").hide();
            $.post("/index.php/Home/Index/confirmSteamLevel", postData, function (data) {
                if (data == null) {
                    showError("请求失败 请再次尝试");
                } else if (data["success"]) {
                    toastr.info("保存成功")
                    getTradeDetail();

                } else if (!data["success"]) {
                    showError(data["error"]);
                    $("#TradeLink").show();
                }
            })
        }

        function confirmTrade() {
            var url = $("#TradeLinkBox").val();
            var steamlevel = $("#steamlevelBox").val();
            var CheckURL = parseURL(url);
            var token = CheckURL.params.token;
            var partner = CheckURL.params.partner;
            if (url == "" || typeof(token) == "undefined" || typeof(partner) == "undefined" || token == void(0) || partner == void(0) || token == "" || partner == "") {
                showError("请输出正确的交易报价链接啊 !!!!!!!!!!!!");
                return;
            }
            if (steamlevel == "" || typeof(steamlevel) == "undefined" ) {
                showError("请输出正确的Steam等级啊 !!!!!!!!!!!!");
                return;
            }

            if(steamlvnow!=steamlevel){
                showError("设置 Steam等级后 请保存,然后提交");
                return;
            }
            if(tradelink!=url){
                showError("设置报价链接后 请保存,然后提交");
                return;
            }
            var postData = {
                TaoBaoID: $("#TaoBaoID").val(),
                steamlevel: steamlevel,
                partner: partner,
                token: token
            }
            $("#TradeLink").hide();
            hideError();
            $.post("/index.php/Home/Index/confirmTrade", postData, function (data) {
                if (data == null) {
                    showError("请求失败 请再次尝试");
                } else if (data["success"]) {
                    getTradeDetail();

                } else if (!data["success"]) {
                    showError(data["error"]);
                    $("#TradeLink").show();
                }
            })
        }


        function getTradeDetail() {
            var postData = {
                TaoBaoID: $("#TaoBaoID").val()
            }
            // 验证是否通过
            $.post("/index.php/Home/Index/getTradeDetail", postData, function (data) {
                if (data == null) {
                    showError("请求失败 请再次尝试");
                } else if (data["success"]) {
                    $('#TaoBaoID').attr("readonly", "readonly");
                    $('#TaoBaoBuyNick').attr("readonly", "readonly");
                    $("#CheckTaoBao1Info").remove();
                    $("#TaoBaoStatusSHOW").val(data["data"]["TaoBaoStatusSHOW"]);
                    $("#TaoBaoBuyerNickSHOW").val(data["data"]["TaoBaoBuyerNickSHOW"]);
                    $("#TaoBaoIdSHOW").val(data["data"]["TaoBaoIdSHOW"]);
                    $("#TaoBaoTitleSHOW").val(data["data"]["TaoBaoTitleSHOW"]);

                    $("#TaoBaoPriceSHOW").val(data["data"]["TaoBaoPriceSHOW"]);
                    $("#TaoBaoOwnerUrlSHOW").val(data["data"]["TaoBaoOwnerUrlSHOW"]);
                    $("#TaoBaoOfferIdSHOW").val(data["data"]["TaoBaoOfferIdSHOW"]);
                    $("#TaoBaoErrorSHOW").val(data["data"]["TaoBaoErrorSHOW"]);


                    $("#SteamlevelToBox").val(data["data"]["TaoBaoToSteamLevelSHOW"]);
                    $("#TaoBaoNumSHOW").val(data["data"]["TaoBaoCardNumSHOW"]);
                    $("#TaoBaoFromLevelSHOW").val(data["data"]["TaoBaoSteamLevelSHOW"]);
                    $("#TaoBaoToLevelSHOW").val(data["data"]["TaoBaoToSteamLevelSHOW"]);
                    $("#steamlevelBox").val(data["data"]["TaoBaoSteamLevelSHOW"]);
                    steamlvnow=data["data"]["TaoBaoSteamLevelSHOW"];
                    tradelink=data["data"]["TaoBaoOwnerUrlSHOW"];
                    if(data["data"]["TaoBaoSteamLevelSHOW"] ==""||data["data"]["TaoBaoOwnerUrlSHOW"].length<=20){

                        $("#Confirm_Trade").text("请保存交易链接,等级后点击领取")
                        $("#Confirm_Trade").attr({"disabled":"true"});
                    }else {
                        $("#Confirm_Trade").text("点击领取")
                        $("#Confirm_Trade").attr({"disabled":false})
                    }
                    if (data["data"]["status"] == "2") {
                        setTimeout(function () {
                            getTradeDetail();
                        }, 10000);
                        showError(data["data"]["TaoBaoErrorSHOW"]);
                    } else if (data["data"]["status"] == "9") {
                        $("#TradeLink").hide();
                        showError(data["data"]["TaoBaoErrorSHOW"]);
                    } else if (data["data"]["status"] == "888") {
                        setTimeout(function () {
                            getTradeDetail();
                        }, 10000);
                    } else if (data["data"]["status"] == "5") {
                        $("#TradeLink").show();
                        showError(data["data"]["TaoBaoErrorSHOW"]);
                    }
                } else if (!data["success"]) {
                    showError(data["error"]);
                }
            });
        }


        function parseURL(url) {
            var a = document.createElement('a');
            a.href = url;
            return {
                source: url,
                protocol: a.protocol.replace(':', ''),
                host: a.hostname,
                port: a.port,
                query: a.search,
                params: (function () {
                    var ret = {},
                            seg = a.search.replace(/^\?/, '').split('&'),
                            len = seg.length, i = 0, s;
                    for (; i < len; i++) {
                        if (!seg[i]) {
                            continue;
                        }
                        s = seg[i].split('=');
                        ret[s[0]] = s[1];
                    }
                    return ret;
                })(),
                file: (a.pathname.match(/\/([^\/?#]+)$/i) || [, ''])[1],
                hash: a.hash.replace('#', ''),
                path: a.pathname.replace(/^([^\/])/, '/$1'),
                relative: (a.href.match(/tps?:\/\/[^\/]+(.+)/) || [, ''])[1],
                segments: a.pathname.replace(/^\//, '').split('/')
            };
        }


        $('input.nowlevel').bind('input propertychange', function () {
            //console.log($(this).val());
            if ($("input.nowlevel").val() != "") {
                if ($("input.tolevel").val() != "") {
                    if (parseInt($("input.nowlevel").val()) < parseInt($("input.tolevel").val())) {
                        //console.log("AJAX GO~");
                        getMoney($("input.nowlevel").val(), $("input.tolevel").val());
                    }
                    else {
                        $("p.Cards-info#needxp").html(0);
                        $("p.Cards-info#totalmoney").html(0);
                        $("p.Cards-info#totalbuycout").html(0);
                        $("p.Cards-info#avgprice").html(0);
                        $("p.Cards-info#showarea").html(0);
                        $("p.Cards-info#maxfriend").html(0);


                    }
                }
            }
        });
        $('input.tolevel').bind('input propertychange', function () {
            //console.log($(this).val());
            if ($("input.nowlevel").val() != "") {
                if ($("input.tolevel").val() != "") {
                    if (parseInt($("input.nowlevel").val()) < parseInt($("input.tolevel").val())) {
                        //console.log("AJAX GO~");
                        getMoney($("input.nowlevel").val(), $("input.tolevel").val());
                    } else {
                        $("p.Cards-info#needxp").html(0);
                        $("p.Cards-info#totalmoney").html(0);
                        $("p.Cards-info#totalbuycout").html(0);
                        $("p.Cards-info#avgprice").html(0);
                        $("p.Cards-info#showarea").html(0);
                        $("p.Cards-info#maxfriend").html(0);


                    }
                }
            }
        });


        function GetXPFromLevel(target_level) {
            var countX = 0;
            var xp = 0;
            var countY;
            var level;
            if (target_level == 0) {
                return 0;
            }
            while (countX < 1200) {
                countY = 1;
                while (countY <= 10) {
                    level = countX * 10 + countY;

                    xp = xp + countX + 1;

                    countY = countY + 1;

                    if (target_level == level) {
                        return xp * 100;
                    }
                }
                countX = countX + 1;
            }
        }


        function AutoGetMoney(nowlevel, tolevel, level) {


            if (parseInt(nowlevel) > parseInt(tolevel)) {
                // console.log(tolevel +"---"+nowlevel+"---"+ nowlevel>tolevel);
                return 0;
            }
            var needxp = GetXPFromLevel(tolevel) - GetXPFromLevel(nowlevel);

            //  console.log(tolevel +"---"+nowlevel+"---" +needxp+"---"+level);
            var needcard = parseInt(needxp / 100);
            var finnalprice = 0;
            if (parseInt(tolevel) > parseInt(pricelevel[level])) {
     
                if (parseInt(nowlevel) >= parseInt(pricelevel[level])) {
                    finnalprice = needcard * price[level];
                } else {
                    finnalprice = AutoGetMoney(nowlevel, pricelevel[level], level - 1) + AutoGetMoney(pricelevel[level], tolevel, level);
                }
            } else {

                finnalprice = AutoGetMoney(nowlevel, tolevel, level - 1)
            }

            return finnalprice;
        }

        var price=[0.8,0.8,0.8,0.9,1.05,1.2,1.3,1.65,1.65,1.65,1.65]    ;
        var pricelevel=[0,10,40,100,130,150,200,250,300,500,9999]  ;



        function getMoney(nowlevel, tolevel) {
            var needxp = GetXPFromLevel(tolevel) - GetXPFromLevel(nowlevel);
            //console.log("xp：" + needxp);

            var finnalprice = 0;


            finnalprice = AutoGetMoney(nowlevel, tolevel, 10);


            var needcard = parseInt(needxp / 100);
            var levelcg = tolevel - nowlevel;
            var friendmax = 255 + 5 * (tolevel - 1);
            var n1 = nowlevel - (nowlevel % 10);
            var n2 = tolevel - (tolevel % 10);
            var showarea = (n2 - n1) / 10;

            var totalbuycout = Math.ceil(finnalprice / 0.5)
            var needmoney = totalbuycout * 0.5;  // (needcard * 0.8).toFixed(2);

            var avgprice = (needmoney / needcard).toFixed(3);
            $("p.Cards-info#needxp").html(needcard);
            $("p.Cards-info#totalmoney").html(needmoney);
            $("p.Cards-info#totalbuycout").html(totalbuycout);
            $("p.Cards-info#avgprice").html(avgprice);
            $("p.Cards-info#showarea").html(showarea);
            $("p.Cards-info#maxfriend").html(friendmax);
        }

    </script>


<script>
    $(function () {
        $('.b-has-child .active').parents('.b-has-child').eq(0).find('.b-nav-parent').click();
    })
</script>
<script defer src="static/js/7b82f3ce4528408d97b64a9c93af574d.js" integrity="sha512-0ahDYl866UMhKuYcW078ScMalXqtFJggm7TmlUtp0UlD4eQk0Ixfnm5ykXKvGJNFjLMoortdseTfsRT8oCfgGA==" data-cf-beacon='{"rayId":"774b5f1fc9470ed0","version":"2022.11.3","r":1,"token":"cf5b04732db340ee8403914100574e88","si":100}' crossorigin="anonymous"></script>
</body>


</html>